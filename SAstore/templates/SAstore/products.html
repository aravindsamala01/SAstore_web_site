{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
  .product-hover img {
    transition: all 0.3s ease;
  }

  .product-hover:hover img {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
  }
</style>

<h2 class="text-3xl font-bold mb-6 text-gray-800">
  DRESSES 
  <span class="text-gray-500 text-base font-normal">({{ products.count }} Products)</span>
</h2>

<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
  {% for product in products %}
  <div class="bg-white rounded-xl shadow-md product-hover p-4 relative flex flex-col">

    {% if product.on_sale %}
    <span class="absolute top-2 left-2 bg-red-600 text-white text-xs font-bold px-2 py-1 rounded z-10">SALE</span>
    {% endif %}

    {% if product.image %}
    <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-64 object-cover rounded-md mb-3">
    {% else %}
    <img src="{% static 'default-image.jpg' %}" alt="No Image" class="w-full h-64 object-cover rounded-md mb-3">
    {% endif %}

    <h3 class="text-md font-semibold text-gray-900 mb-1 truncate">{{ product.name }}</h3>

    {% if product.rating %}
    <div class="text-sm text-yellow-600 mb-1">
      ⭐ {{ product.rating }} <span class="text-gray-500">| {{ product.rating_count }}</span>
    </div>
    {% endif %}

    <div class="mb-2">
      {% if product.on_sale %}
      <span class="text-gray-400 line-through text-sm">₹{{ product.original_price }}</span>
      <span class="text-green-700 font-semibold text-md ml-2">₹{{ product.price }}</span>
      <span class="text-red-500 text-sm font-semibold ml-2">({{ product.discount_percentage }}% OFF)</span>
      {% else %}
      <span class="text-black font-semibold text-md">₹{{ product.price }}</span>
      {% endif %}
    </div>

    {% if product.colors.all %}
    <div class="flex items-center space-x-2 mb-4">
      {% for color in product.colors.all %}
      <span class="w-4 h-4 rounded-full border border-gray-300" style="background-color: {{ color.hex_code }};"></span>
      {% endfor %}
    </div>
    {% endif %}

    <div class="mt-auto">
      <form method="post" action="{% url 'add_to_cart' product.id %}">
        {% csrf_token %}
        <button type="submit" class="w-full bg-black text-white text-sm px-4 py-2 rounded-md hover:bg-gray-800 transition">
          Add to Cart
        </button>
      </form>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}
